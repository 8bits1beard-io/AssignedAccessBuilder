<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AssignedAccess XML Builder - Windows 11 Kiosk Configuration</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Skip Link for Keyboard Users -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <header role="banner">
        <h1>
            <span class="logo" aria-hidden="true">AAXB</span>
            AssignedAccess XML Builder
            <span class="subtitle">Windows 11 23H2+</span>
        </h1>
        <nav class="header-actions" aria-label="Main actions">
            <button type="button" class="btn-secondary" onclick="loadPreset('blank')">New</button>
            <button type="button" class="btn-secondary" onclick="importXml()">Import XML</button>
            <button type="button" class="btn-secondary" onclick="showDeployHelp()">Deploy Guide</button>
            <button type="button" class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle light mode" title="Toggle light mode">
                <span aria-hidden="true">&#9728;</span>
            </button>
        </nav>
    </header>

    <main id="main-content" class="container">
        <!-- Configuration Panel -->
        <section class="panel" aria-labelledby="config-heading">
            <h2 id="config-heading" class="panel-header">
                Configuration
            </h2>
            <div class="panel-content with-tabs">
                <!-- Tab Navigation -->
                <nav class="tab-nav" role="tablist" aria-label="Configuration sections">
                    <button type="button" class="tab-btn active" role="tab" aria-selected="true" aria-controls="tab-setup" id="tab-btn-setup" onclick="switchTab('setup')">Setup</button>
                    <button type="button" class="tab-btn" role="tab" aria-selected="false" aria-controls="tab-application" id="tab-btn-application" onclick="switchTab('application')">Application</button>
                    <button type="button" class="tab-btn" role="tab" aria-selected="false" aria-controls="tab-startmenu" id="tab-btn-startmenu" onclick="switchTab('startmenu')">Start Menu</button>
                    <button type="button" class="tab-btn" role="tab" aria-selected="false" aria-controls="tab-system" id="tab-btn-system" onclick="switchTab('system')">System</button>
                </nav>

                <!-- Tab Panels -->
                <div class="tab-panels">
                    <!-- Setup Tab -->
                    <div class="tab-content active" role="tabpanel" id="tab-setup" aria-labelledby="tab-btn-setup">
                        <!-- Kiosk Mode -->
                        <fieldset class="section">
                    <legend class="section-header">Kiosk Mode</legend>
                    <div class="section-content">
                        <div class="toggle-group" role="group" aria-label="Kiosk mode selection">
                            <button type="button" id="modeSingle" class="active" onclick="setMode('single')" aria-pressed="true">Single-App</button>
                            <button type="button" id="modeMulti" onclick="setMode('multi')" aria-pressed="false">Multi-App</button>
                            <button type="button" id="modeRestricted" onclick="setMode('restricted')" aria-pressed="false">Restricted User</button>
                        </div>
                        <p class="hint" style="margin-top: 10px;" id="kiosk-mode-hint">
                            <strong>Single-App:</strong> Runs one app fullscreen (e.g., Edge kiosk)<br>
                            <strong>Multi-App:</strong> Allows multiple apps with custom Start menu<br>
                            <strong>Restricted User:</strong> Desktop with limited apps, supports user groups
                        </p>
                    </div>
                </fieldset>

                <!-- Profile Configuration -->
                <fieldset class="section">
                    <legend class="section-header">Profile</legend>
                    <div class="section-content">
                        <div class="form-group">
                            <label for="configName" class="with-tooltip">
                                Configuration Name
                                <button type="button" class="tooltip-icon" aria-label="Help for Configuration Name" aria-describedby="configName-tooltip">?</button>
                                <span class="tooltip-content" id="configName-tooltip" role="tooltip">A friendly name for this configuration. Used in downloaded file names (e.g., "Lobby-Kiosk" becomes "AssignedAccess-Lobby-Kiosk.xml"). Leave blank for default naming.</span>
                            </label>
                            <input type="text" id="configName" placeholder="e.g., Lobby-Kiosk, Reception-PC" onchange="updatePreview()" aria-describedby="configName-tooltip">
                        </div>
                        <div class="form-group">
                            <label for="profileId" class="with-tooltip">
                                Profile GUID
                                <button type="button" class="tooltip-icon" aria-label="Help for Profile GUID" aria-describedby="profileId-tooltip">?</button>
                                <span class="tooltip-content" id="profileId-tooltip" role="tooltip">A unique identifier for this kiosk profile. Each profile needs its own GUID. Click "Generate" to create a random one. This ID links the profile configuration to the account that will use it.</span>
                            </label>
                            <div class="input-group">
                                <input type="text" id="profileId" placeholder="{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}" onchange="updatePreview()" aria-describedby="profileId-tooltip">
                                <button type="button" class="btn-secondary" onclick="generateGuid()">Generate</button>
                                <button type="button" class="btn-secondary btn-small" onclick="copyToClipboard(document.getElementById('profileId').value)" aria-label="Copy Profile GUID to clipboard">
                                    <span aria-hidden="true">&#128203;</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </fieldset>

                <!-- Account Configuration -->
                <fieldset class="section">
                    <legend class="section-header">Account</legend>
                    <div class="section-content">
                        <div class="form-group">
                            <label id="account-type-label" class="with-tooltip">
                                Account Type
                                <button type="button" class="tooltip-icon" aria-label="Help for Account Type" aria-describedby="accountType-tooltip">?</button>
                                <span class="tooltip-content" id="accountType-tooltip" role="tooltip"><strong>Auto Logon:</strong> Windows creates and manages a local account automatically. Best for most kiosks - no password needed, auto-logs in at boot.<br><br><strong>Existing Account:</strong> Use a pre-created local, domain, or Azure AD account. Use this if you need specific permissions or domain integration.</span>
                            </label>
                            <div class="toggle-group" role="group" aria-labelledby="account-type-label" id="accountTypeButtons">
                                <button type="button" id="accountAuto" class="active" onclick="setAccountType('auto')" aria-pressed="true">Auto Logon (Managed)</button>
                                <button type="button" id="accountExisting" onclick="setAccountType('existing')" aria-pressed="false">Existing Account</button>
                                <button type="button" id="accountGroup" class="hidden" onclick="setAccountType('group')" aria-pressed="false">User Group</button>
                                <button type="button" id="accountGlobal" class="hidden" onclick="setAccountType('global')" aria-pressed="false">Global Profile</button>
                            </div>
                        </div>

                        <div id="autoLogonConfig">
                            <div class="form-group">
                                <label for="displayName" class="with-tooltip">
                                    Display Name
                                    <button type="button" class="tooltip-icon" aria-label="Help for Display Name" aria-describedby="displayName-tooltip">?</button>
                                    <span class="tooltip-content" id="displayName-tooltip" role="tooltip">The friendly name shown on the Windows login screen. Windows will create a managed local account (typically "kioskUser0") that auto-logs in. This display name is just for identification.</span>
                                </label>
                                <input type="text" id="displayName" placeholder="e.g., Kiosk User" onchange="updatePreview()" aria-describedby="displayName-tooltip">
                            </div>
                        </div>

                        <div id="existingAccountConfig" class="hidden" aria-hidden="true">
                            <div class="form-group">
                                <label for="accountName" class="with-tooltip">
                                    Account Name
                                    <button type="button" class="tooltip-icon" aria-label="Help for Account Name" aria-describedby="accountName-tooltip">?</button>
                                    <span class="tooltip-content" id="accountName-tooltip" role="tooltip">The username of an existing account. Formats: Local: KioskUser, Domain: DOMAIN\KioskUser, Azure AD: AzureAD\user@domain.com. The account must exist before the kiosk config is applied.</span>
                                </label>
                                <input type="text" id="accountName" placeholder="e.g., DOMAIN\\KioskUser or KioskUser" onchange="updatePreview()" aria-describedby="accountName-tooltip">
                            </div>
                        </div>

                        <div id="groupAccountConfig" class="hidden" aria-hidden="true">
                            <div class="form-group">
                                <label for="groupType" class="with-tooltip">
                                    Group Type
                                    <button type="button" class="tooltip-icon" aria-label="Help for Group Type" aria-describedby="groupType-tooltip">?</button>
                                    <span class="tooltip-content" id="groupType-tooltip" role="tooltip">Select the type of group to apply this profile to. All members of the group will get the restricted experience.</span>
                                </label>
                                <select id="groupType" onchange="updatePreview()" aria-describedby="groupType-tooltip">
                                    <option value="LocalGroup">Local Group</option>
                                    <option value="ActiveDirectoryGroup">Active Directory Group</option>
                                    <option value="AzureActiveDirectoryGroup">Azure AD Group</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="groupName" class="with-tooltip">
                                    Group Name
                                    <button type="button" class="tooltip-icon" aria-label="Help for Group Name" aria-describedby="groupName-tooltip">?</button>
                                    <span class="tooltip-content" id="groupName-tooltip" role="tooltip">Local: GroupName. AD: DOMAIN\GroupName. Azure AD: Use the Group Object ID (GUID). The group must exist before the config is applied.</span>
                                </label>
                                <input type="text" id="groupName" placeholder="e.g., KioskUsers or DOMAIN\\KioskGroup" onchange="updatePreview()" aria-describedby="groupName-tooltip">
                            </div>
                        </div>

                        <div id="globalProfileConfig" class="hidden" aria-hidden="true">
                            <p class="hint">
                                <strong>Global Profile:</strong> This profile applies to ALL non-administrator users on the device. No specific account or group configuration needed.
                            </p>
                        </div>
                    </div>
                </fieldset>
                    </div>
                    <!-- End Setup Tab -->

                    <!-- Application Tab -->
                    <div class="tab-content" role="tabpanel" id="tab-application" aria-labelledby="tab-btn-application">
                <!-- Single-App Configuration -->
                <div id="singleAppConfig">
                    <fieldset class="section">
                        <legend class="section-header">Single-App Settings</legend>
                        <div class="section-content">
                            <div class="form-group">
                                <label for="appType" class="with-tooltip">
                                    Application Type
                                    <button type="button" class="tooltip-icon" aria-label="Help for Application Type" aria-describedby="appType-tooltip">?</button>
                                    <span class="tooltip-content" id="appType-tooltip" role="tooltip"><strong>Edge Kiosk:</strong> Best for web apps and local HTML. Native kiosk support with idle timeout. <strong>UWP:</strong> Store apps with clean sandboxed integration. <strong>Win32:</strong> Traditional desktop apps. May have RestrictRun issues - use Edge or UWP when possible.</span>
                                </label>
                                <select id="appType" onchange="updateAppTypeUI(); updatePreview();" aria-describedby="appType-tooltip">
                                    <option value="edge">Microsoft Edge (Kiosk Mode)</option>
                                    <option value="uwp">UWP / Store App</option>
                                    <option value="win32">Win32 Desktop App</option>
                                </select>
                            </div>

                            <!-- Edge Configuration -->
                            <div id="edgeConfig" role="group" aria-label="Microsoft Edge settings">
                                <div class="form-group">
                                    <label for="edgeSourceType" class="with-tooltip">
                                        Load From
                                        <button type="button" class="tooltip-icon" aria-label="Help for Load From" aria-describedby="edgeSourceType-tooltip">?</button>
                                        <span class="tooltip-content" id="edgeSourceType-tooltip" role="tooltip">Choose where Edge loads content from. <strong>Web URL:</strong> A website (https://example.com). <strong>Local File:</strong> An HTML file on the device (C:\Kiosk\page.html).</span>
                                    </label>
                                    <select id="edgeSourceType" onchange="updateEdgeSourceUI(); updatePreview();" aria-describedby="edgeSourceType-tooltip">
                                        <option value="url">Web URL</option>
                                        <option value="file">Local File</option>
                                    </select>
                                </div>

                                <div id="edgeUrlConfig" class="form-group">
                                    <label for="edgeUrl" class="with-tooltip">
                                        URL
                                        <button type="button" class="tooltip-icon" aria-label="Help for URL" aria-describedby="edgeUrl-tooltip">?</button>
                                        <span class="tooltip-content" id="edgeUrl-tooltip" role="tooltip">The web address Edge will load in kiosk mode. Include the full URL with https://. You can also use file:/// URLs directly (use %20 for spaces in paths).</span>
                                    </label>
                                    <input type="text" id="edgeUrl" placeholder="https://example.com" onchange="updatePreview()" aria-describedby="edgeUrl-tooltip">
                                </div>

                                <div id="edgeFileConfig" class="form-group hidden" aria-hidden="true">
                                    <label for="edgeFilePath" class="with-tooltip">
                                        File Path
                                        <button type="button" class="tooltip-icon" aria-label="Help for File Path" aria-describedby="edgeFilePath-tooltip">?</button>
                                        <span class="tooltip-content" id="edgeFilePath-tooltip" role="tooltip">Full path to an HTML file on the local device. Use forward slashes. Spaces in the path will be automatically converted to %20.</span>
                                    </label>
                                    <input type="text" id="edgeFilePath" placeholder="C:/Kiosk/index.html" onchange="updatePreview()" aria-describedby="edgeFilePath-tooltip">
                                    <p class="hint" style="margin-top: 6px;">
                                        <strong>Tip:</strong> Use forward slashes (/) in the path. Spaces are converted automatically.<br>
                                        Example: <code>C:/Program Files/Kiosk/page.html</code> â†’ <code>file:///C:/Program%20Files/Kiosk/page.html</code>
                                    </p>
                                </div>

                                <div class="form-group">
                                    <label for="edgeKioskType" class="with-tooltip">
                                        Kiosk Type
                                        <button type="button" class="tooltip-icon" aria-label="Help for Kiosk Type" aria-describedby="edgeKioskType-tooltip">?</button>
                                        <span class="tooltip-content" id="edgeKioskType-tooltip" role="tooltip"><strong>Fullscreen:</strong> Shows only the webpage with no browser UI. Ideal for digital signage. <strong>Public Browsing:</strong> Shows address bar and navigation. Users can browse but sessions reset on idle. Both modes always run InPrivate (no history/cookies saved).</span>
                                    </label>
                                    <select id="edgeKioskType" onchange="updatePreview()" aria-describedby="edgeKioskType-tooltip">
                                        <option value="fullscreen">Fullscreen (Digital Signage)</option>
                                        <option value="public-browsing">Public Browsing</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="edgeIdleTimeout" class="with-tooltip">
                                        Idle Timeout (minutes)
                                        <button type="button" class="tooltip-icon" aria-label="Help for Idle Timeout" aria-describedby="edgeIdleTimeout-tooltip">?</button>
                                        <span class="tooltip-content" id="edgeIdleTimeout-tooltip" role="tooltip">After this many minutes of no user activity, Edge will reset to the home URL and clear the session. Set to 0 to disable timeout. Recommended for public kiosks.</span>
                                    </label>
                                    <input type="number" id="edgeIdleTimeout" min="0" max="1440" value="0" placeholder="0 = disabled" onchange="updatePreview()" aria-describedby="edgeIdleTimeout-tooltip">
                                </div>
                            </div>

                            <!-- UWP App Configuration -->
                            <div id="uwpConfig" class="hidden" aria-hidden="true" role="group" aria-label="UWP App settings">
                                <div class="form-group">
                                    <label for="uwpAumid" class="with-tooltip">
                                        App User Model ID (AUMID)
                                        <button type="button" class="tooltip-icon" aria-label="Help for AUMID" aria-describedby="uwpAumid-tooltip">?</button>
                                        <span class="tooltip-content" id="uwpAumid-tooltip" role="tooltip">The unique identifier for a UWP/Store app. Format: PackageName_PublisherId!AppId. To find an app's AUMID, run this in PowerShell: Get-StartApps | Format-Table Name, AppID</span>
                                    </label>
                                    <input type="text" id="uwpAumid" placeholder="e.g., Microsoft.WindowsCalculator_8wekyb3d8bbwe!App" onchange="updatePreview()" aria-describedby="uwpAumid-tooltip">
                                </div>
                            </div>

                            <!-- Win32 App Configuration -->
                            <div id="win32Config" class="hidden" aria-hidden="true" role="group" aria-label="Win32 App settings">
                                <div class="form-group">
                                    <label for="win32Path" class="with-tooltip">
                                        Application Path
                                        <button type="button" class="tooltip-icon" aria-label="Help for Application Path" aria-describedby="win32Path-tooltip">?</button>
                                        <span class="tooltip-content" id="win32Path-tooltip" role="tooltip">Full path to the .exe file. Warning: Win32 apps use DesktopAppPath which creates RestrictRun registry entries. This can cause "operation cancelled due to restrictions" errors. Consider using Edge Kiosk mode instead when possible.</span>
                                    </label>
                                    <input type="text" id="win32Path" placeholder="e.g., C:\Program Files\MyApp\app.exe" onchange="updatePreview()" aria-describedby="win32Path-tooltip">
                                </div>
                                <div class="form-group">
                                    <label for="win32Args" class="with-tooltip">
                                        Arguments (optional)
                                        <button type="button" class="tooltip-icon" aria-label="Help for Arguments" aria-describedby="win32Args-tooltip">?</button>
                                        <span class="tooltip-content" id="win32Args-tooltip" role="tooltip">Command-line arguments passed to the application at launch. For example: --fullscreen or --kiosk</span>
                                    </label>
                                    <input type="text" id="win32Args" placeholder="e.g., --fullscreen" onchange="updatePreview()" aria-describedby="win32Args-tooltip">
                                </div>
                            </div>

                            <!-- Breakout Sequence -->
                            <div class="form-group" style="margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--border);">
                                <div class="checkbox-group">
                                    <span class="toggle-switch">
                                        <input type="checkbox" id="enableBreakout" onchange="updateBreakoutUI(); updatePreview()" aria-describedby="enableBreakout-tooltip">
                                        <span class="toggle-slider" aria-hidden="true"></span>
                                    </span>
                                    <label for="enableBreakout" class="with-tooltip">
                                        Enable Breakout Sequence
                                        <button type="button" class="tooltip-icon" aria-label="Help for Breakout Sequence" aria-describedby="enableBreakout-tooltip">?</button>
                                        <span class="tooltip-content" id="enableBreakout-tooltip" role="tooltip">Allows technicians to exit kiosk mode using a key combination. Useful for troubleshooting without rebooting. The user will be taken to the Windows lock screen.</span>
                                    </label>
                                </div>
                            </div>
                            <div id="breakoutConfig" class="hidden" aria-hidden="true">
                                <div class="form-group">
                                    <label id="breakoutKey-label" class="with-tooltip">
                                        Key Combination
                                        <button type="button" class="tooltip-icon" aria-label="Help for Key Combination" aria-describedby="breakoutKey-tooltip">?</button>
                                        <span class="tooltip-content" id="breakoutKey-tooltip" role="tooltip">The key combination to exit kiosk mode. Choose modifier keys and a final key. Avoid common shortcuts like Ctrl+C or Ctrl+V. Something obscure like Ctrl+Alt+K works well.</span>
                                    </label>
                                    <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;" role="group" aria-labelledby="breakoutKey-label">
                                        <label style="display: flex; align-items: center; gap: 4px; font-weight: normal;">
                                            <input type="checkbox" id="breakoutCtrl" checked onchange="updateBreakoutPreview(); updatePreview()"> Ctrl
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 4px; font-weight: normal;">
                                            <input type="checkbox" id="breakoutAlt" checked onchange="updateBreakoutPreview(); updatePreview()"> Alt
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 4px; font-weight: normal;">
                                            <input type="checkbox" id="breakoutShift" onchange="updateBreakoutPreview(); updatePreview()"> Shift
                                        </label>
                                        <span aria-hidden="true">+</span>
                                        <label for="breakoutFinalKey" class="sr-only">Final key</label>
                                        <select id="breakoutFinalKey" onchange="updateBreakoutPreview(); updatePreview()" style="width: auto;">
                                            <option value="A">A</option>
                                            <option value="B">B</option>
                                            <option value="C">C</option>
                                            <option value="D">D</option>
                                            <option value="E">E</option>
                                            <option value="F">F</option>
                                            <option value="G">G</option>
                                            <option value="H">H</option>
                                            <option value="I">I</option>
                                            <option value="J">J</option>
                                            <option value="K" selected>K</option>
                                            <option value="L">L</option>
                                            <option value="M">M</option>
                                            <option value="N">N</option>
                                            <option value="O">O</option>
                                            <option value="P">P</option>
                                            <option value="Q">Q</option>
                                            <option value="R">R</option>
                                            <option value="S">S</option>
                                            <option value="T">T</option>
                                            <option value="U">U</option>
                                            <option value="V">V</option>
                                            <option value="W">W</option>
                                            <option value="X">X</option>
                                            <option value="Y">Y</option>
                                            <option value="Z">Z</option>
                                            <option value="0">0</option>
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                            <option value="6">6</option>
                                            <option value="7">7</option>
                                            <option value="8">8</option>
                                            <option value="9">9</option>
                                            <option value="F1">F1</option>
                                            <option value="F2">F2</option>
                                            <option value="F3">F3</option>
                                            <option value="F4">F4</option>
                                            <option value="F5">F5</option>
                                            <option value="F6">F6</option>
                                            <option value="F7">F7</option>
                                            <option value="F8">F8</option>
                                            <option value="F9">F9</option>
                                            <option value="F10">F10</option>
                                            <option value="F11">F11</option>
                                            <option value="F12">F12</option>
                                        </select>
                                    </div>
                                    <p class="hint" style="margin-top: 8px;">
                                        Current: <strong id="breakoutPreview" aria-live="polite">Ctrl+Alt+K</strong>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </div>

                <!-- Multi-App Configuration -->
                <div id="multiAppConfig" class="hidden" aria-hidden="true">
                    <fieldset class="section">
                        <legend class="section-header">Allowed Applications</legend>
                        <div class="section-content">
                            <div class="form-group">
                                <label id="addApp-label" class="with-tooltip">
                                    Add Application
                                    <button type="button" class="tooltip-icon" aria-label="Help for Add Application" aria-describedby="addApp-tooltip">?</button>
                                    <span class="tooltip-content" id="addApp-tooltip" role="tooltip">Add apps that users can access in multi-app kiosk mode. Path: Full path to .exe file for Win32 apps. AUMID: App User Model ID for UWP/Store apps. Run Get-StartApps in PowerShell to find these.</span>
                                </label>
                                <div class="input-group" role="group" aria-labelledby="addApp-label">
                                    <label for="addAppType" class="sr-only">Application type</label>
                                    <select id="addAppType" style="width: 150px;">
                                        <option value="path">Path (.exe)</option>
                                        <option value="aumid">AUMID (UWP)</option>
                                    </select>
                                    <label for="addAppValue" class="sr-only">Application path or AUMID</label>
                                    <input type="text" id="addAppValue" placeholder="Path or AUMID">
                                    <button type="button" class="btn-primary" onclick="addApp()">Add</button>
                                </div>
                            </div>

                            <div class="form-group">
                                <label id="commonApps-label" class="with-tooltip">
                                    Common Apps
                                    <button type="button" class="tooltip-icon" aria-label="Help for Common Apps" aria-describedby="commonApps-tooltip">?</button>
                                    <span class="tooltip-content" id="commonApps-tooltip" role="tooltip">Quick-add frequently needed apps. Edge includes all required components (msedge.exe, proxy, AUMID). On-Screen Keyboard is useful for touchscreen kiosks.</span>
                                </label>
                                <p class="hint" style="margin-bottom: 8px;">
                                    <strong>Note:</strong> Common apps use default installation paths. If an app is installed in a custom location, use "Add Application" above instead.
                                </p>
                                <div role="group" aria-labelledby="commonApps-label">
                                    <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 8px;">
                                        <strong style="width: 100%; font-size: 0.8rem; color: var(--text-secondary);">Browsers:</strong>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('edge')">Edge</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('chrome')">Chrome</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('firefox')">Firefox</button>
                                    </div>
                                    <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 8px;">
                                        <strong style="width: 100%; font-size: 0.8rem; color: var(--text-secondary);">System Utilities:</strong>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('osk')">On-Screen Keyboard</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('volume')">Volume Control</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('settings')">Settings</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('fileExplorer')">File Explorer</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('printers')">Printers</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('printSpooler')">Print Spooler</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('controlPanel')">Control Panel</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('cmd')">Command Prompt</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('powershell')">PowerShell</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('terminal')">Windows Terminal</button>
                                    </div>
                                    <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 8px;">
                                        <strong style="width: 100%; font-size: 0.8rem; color: var(--text-secondary);">Productivity:</strong>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('calculator')">Calculator</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('notepad')">Notepad</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('paint')">Paint</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('snipSketch')">Snipping Tool</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('stickyNotes')">Sticky Notes</button>
                                    </div>
                                    <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 8px;">
                                        <strong style="width: 100%; font-size: 0.8rem; color: var(--text-secondary);">Media &amp; Communication:</strong>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('photos')">Photos</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('camera')">Camera</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('movies')">Movies &amp; TV</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('teams')">Teams</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('zoom')">Zoom</button>
                                    </div>
                                    <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                                        <strong style="width: 100%; font-size: 0.8rem; color: var(--text-secondary);">Microsoft Office:</strong>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('word')">Word</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('excel')">Excel</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('powerpoint')">PowerPoint</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('outlook')">Outlook</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonApp('onenote')">OneNote</button>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label id="appList-label">Allowed Apps (<span id="appCount" aria-live="polite">0</span>)</label>
                                <div class="app-list" id="appList" role="list" aria-labelledby="appList-label" aria-live="polite">
                                    <div class="empty-list" role="listitem">No apps added yet</div>
                                </div>
                            </div>
                        </div>
                    </fieldset>

                    <fieldset class="section">
                        <legend class="section-header">Auto-Launch Configuration</legend>
                        <div class="section-content">
                            <div class="form-group">
                                <label for="autoLaunchApp" class="with-tooltip">
                                    Launch on Startup
                                    <button type="button" class="tooltip-icon" aria-label="Help for Auto-Launch" aria-describedby="autoLaunch-tooltip">?</button>
                                    <span class="tooltip-content" id="autoLaunch-tooltip" role="tooltip">Automatically launch this app when the kiosk user signs in. The app will start immediately, providing a single-app experience while still allowing access to other whitelisted apps.</span>
                                </label>
                                <select id="autoLaunchApp" onchange="updateAutoLaunchSelection(); updatePreview();" aria-describedby="autoLaunch-tooltip">
                                    <option value="">None (show Start menu)</option>
                                </select>
                            </div>
                        </div>
                    </fieldset>

                    <fieldset class="section hidden" id="multiAppEdgeConfig" aria-hidden="true">
                        <legend class="section-header">Edge Kiosk Settings</legend>
                        <div class="section-content">
                            <div class="form-group">
                                <label for="multiEdgeSourceType" class="with-tooltip">
                                    URL Source
                                    <button type="button" class="tooltip-icon" aria-label="Help for URL Source" aria-describedby="multiEdgeSource-tooltip">?</button>
                                    <span class="tooltip-content" id="multiEdgeSource-tooltip" role="tooltip">Choose whether Edge should open a web URL or a local HTML file when auto-launched.</span>
                                </label>
                                <select id="multiEdgeSourceType" onchange="updateMultiEdgeSourceUI(); updatePreview();" aria-describedby="multiEdgeSource-tooltip">
                                    <option value="url">Web URL</option>
                                    <option value="file">Local File (file:// URL)</option>
                                </select>
                            </div>

                            <div class="form-group" id="multiEdgeUrlGroup">
                                <label for="multiEdgeUrl" class="with-tooltip">
                                    Kiosk URL
                                    <button type="button" class="tooltip-icon" aria-label="Help for Kiosk URL" aria-describedby="multiEdgeUrl-tooltip">?</button>
                                    <span class="tooltip-content" id="multiEdgeUrl-tooltip" role="tooltip">The URL that Edge will open in kiosk mode. This is your landing page where you can provide links to whitelisted utilities.</span>
                                </label>
                                <input type="text" id="multiEdgeUrl" placeholder="https://example.com" onchange="updatePreview()" aria-describedby="multiEdgeUrl-tooltip">
                            </div>

                            <div class="form-group hidden" id="multiEdgeFileGroup" aria-hidden="true">
                                <label for="multiEdgeFilePath" class="with-tooltip">
                                    Local File Path
                                    <button type="button" class="tooltip-icon" aria-label="Help for Local File Path" aria-describedby="multiEdgeFile-tooltip">?</button>
                                    <span class="tooltip-content" id="multiEdgeFile-tooltip" role="tooltip">Path to a local HTML file (e.g., C:\Kiosk\index.html). The path will be converted to a file:// URL.</span>
                                </label>
                                <input type="text" id="multiEdgeFilePath" placeholder="C:\Kiosk\index.html" onchange="updatePreview()" aria-describedby="multiEdgeFile-tooltip">
                            </div>

                            <div class="form-group">
                                <label for="multiEdgeKioskType" class="with-tooltip">
                                    Kiosk Mode Type
                                    <button type="button" class="tooltip-icon" aria-label="Help for Kiosk Mode Type" aria-describedby="multiEdgeKiosk-tooltip">?</button>
                                    <span class="tooltip-content" id="multiEdgeKiosk-tooltip" role="tooltip">Fullscreen: No browser UI, just the web content. Public Browsing: Shows address bar and navigation for controlled browsing. Both modes always run InPrivate (no history/cookies saved).</span>
                                </label>
                                <select id="multiEdgeKioskType" onchange="updatePreview()" aria-describedby="multiEdgeKiosk-tooltip">
                                    <option value="fullscreen">Fullscreen (no browser UI)</option>
                                    <option value="public-browsing">Public Browsing (with navigation)</option>
                                </select>
                            </div>
                        </div>
                    </fieldset>

                    <fieldset class="section hidden" id="win32ArgsConfig" aria-hidden="true">
                        <legend class="section-header">Win32 App Arguments</legend>
                        <div class="section-content">
                            <div class="form-group">
                                <label for="win32AutoLaunchArgs" class="with-tooltip">
                                    Launch Arguments
                                    <button type="button" class="tooltip-icon" aria-label="Help for Launch Arguments" aria-describedby="win32Args-tooltip">?</button>
                                    <span class="tooltip-content" id="win32Args-tooltip" role="tooltip">Optional command-line arguments to pass to the Win32 application when it auto-launches. Example: --fullscreen or /silent</span>
                                </label>
                                <input type="text" id="win32AutoLaunchArgs" placeholder="--fullscreen /silent" onchange="updatePreview()" aria-describedby="win32Args-tooltip">
                            </div>
                        </div>
                    </fieldset>
                </div>
                    </div>
                    <!-- End Application Tab -->

                    <!-- Start Menu Tab (Multi-App only) -->
                    <div class="tab-content" role="tabpanel" id="tab-startmenu" aria-labelledby="tab-btn-startmenu">
                    <fieldset class="section">
                        <legend class="section-header">Start Menu Pins</legend>
                        <div class="section-content">
                            <div class="form-group">
                                <label class="with-tooltip">
                                    Add Custom Shortcut
                                    <button type="button" class="tooltip-icon" aria-label="Help for Add Shortcut" aria-describedby="addShortcut-tooltip">?</button>
                                    <span class="tooltip-content" id="addShortcut-tooltip" role="tooltip">Create shortcuts that will be pinned to the Start menu. The deployment script will create these .lnk files automatically.</span>
                                </label>
                                <div style="display: flex; flex-direction: column; gap: 8px; padding: 10px; background: var(--bg-tertiary); border-radius: 6px;">
                                    <div style="display: flex; gap: 8px;">
                                        <div style="flex: 1;">
                                            <label for="pinName" style="font-size: 0.75rem; color: var(--text-secondary);">Shortcut Name *</label>
                                            <input type="text" id="pinName" placeholder="e.g., Microsoft Edge" style="width: 100%;">
                                        </div>
                                        <div style="flex: 2;">
                                            <label for="pinTarget" style="font-size: 0.75rem; color: var(--text-secondary);">Target Path *</label>
                                            <input type="text" id="pinTarget" placeholder="e.g., C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe" style="width: 100%;">
                                        </div>
                                    </div>
                                    <div>
                                        <label for="pinArgs" style="font-size: 0.75rem; color: var(--text-secondary);">Arguments (optional)</label>
                                        <input type="text" id="pinArgs" placeholder="e.g., --kiosk https://example.com --edge-kiosk-type=fullscreen" style="width: 100%;">
                                    </div>
                                    <div style="display: flex; gap: 8px;">
                                        <div style="flex: 1;">
                                            <label for="pinWorkingDir" style="font-size: 0.75rem; color: var(--text-secondary);">Working Directory (optional)</label>
                                            <input type="text" id="pinWorkingDir" placeholder="e.g., C:\Program Files (x86)\Microsoft\Edge\Application" style="width: 100%;">
                                        </div>
                                        <div style="flex: 1;">
                                            <label for="pinIconPath" style="font-size: 0.75rem; color: var(--text-secondary);">Icon Path (optional)</label>
                                            <input type="text" id="pinIconPath" placeholder="e.g., C:\path\to\icon.ico" style="width: 100%;">
                                        </div>
                                    </div>
                                    <div style="font-size: 0.7rem; color: var(--text-secondary); font-style: italic;">
                                        Note: If icon path is specified, you are responsible for ensuring the icon file exists at that path.
                                    </div>
                                    <button type="button" class="btn-primary" onclick="addPin()" style="align-self: flex-start;">Add Shortcut</button>
                                </div>
                            </div>

                            <div class="form-group">
                                <label id="commonPins-label" class="with-tooltip">
                                    Common Pins
                                    <button type="button" class="tooltip-icon" aria-label="Help for Common Pins" aria-describedby="commonPins-tooltip">?</button>
                                    <span class="tooltip-content" id="commonPins-tooltip" role="tooltip">Quick-add common shortcuts with pre-configured targets. Make sure the corresponding app is also in your Allowed Applications list.</span>
                                </label>
                                <p class="hint" style="margin-bottom: 8px;">
                                    <strong>Note:</strong> Common pins use default installation paths. If an app is installed in a custom location, use "Add Custom Shortcut" above instead.
                                </p>
                                <div role="group" aria-labelledby="commonPins-label">
                                    <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 8px;">
                                        <strong style="width: 100%; font-size: 0.8rem; color: var(--text-secondary);">Browsers:</strong>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('edge')">Edge</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('chrome')">Chrome</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('firefox')">Firefox</button>
                                    </div>
                                    <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 8px;">
                                        <strong style="width: 100%; font-size: 0.8rem; color: var(--text-secondary);">System Utilities:</strong>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('osk')">On-Screen Keyboard</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('soundSettings')">Sound Settings</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('settings')">Settings</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('fileExplorer')">File Explorer</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('printers')">Printers</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('printSpooler')">Print Spooler</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('controlPanel')">Control Panel</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('cmd')">Command Prompt</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('powershell')">PowerShell</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('terminal')">Windows Terminal</button>
                                    </div>
                                    <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 8px;">
                                        <strong style="width: 100%; font-size: 0.8rem; color: var(--text-secondary);">Productivity:</strong>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('calculator')">Calculator</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('notepad')">Notepad</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('paint')">Paint</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('snipSketch')">Snipping Tool</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('stickyNotes')">Sticky Notes</button>
                                    </div>
                                    <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 8px;">
                                        <strong style="width: 100%; font-size: 0.8rem; color: var(--text-secondary);">Media &amp; Communication:</strong>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('photos')">Photos</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('camera')">Camera</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('movies')">Movies &amp; TV</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('teams')">Teams</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('zoom')">Zoom</button>
                                    </div>
                                    <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                                        <strong style="width: 100%; font-size: 0.8rem; color: var(--text-secondary);">Microsoft Office:</strong>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('word')">Word</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('excel')">Excel</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('powerpoint')">PowerPoint</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('outlook')">Outlook</button>
                                        <button type="button" class="btn-secondary btn-small" onclick="addCommonPin('onenote')">OneNote</button>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label id="pinList-label">Pinned Shortcuts (<span id="pinCount" aria-live="polite">0</span>)</label>
                                <div class="app-list" id="pinList" role="list" aria-labelledby="pinList-label" aria-live="polite">
                                    <div class="empty-list" role="listitem">No pins added yet</div>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                    </div>
                    <!-- End Start Menu Tab -->

                    <!-- System Tab (Multi-App only) -->
                    <div class="tab-content" role="tabpanel" id="tab-system" aria-labelledby="tab-btn-system">
                    <fieldset class="section">
                        <legend class="section-header">Taskbar &amp; File Explorer</legend>
                        <div class="section-content">
                            <div class="form-group">
                                <div class="checkbox-group">
                                    <span class="toggle-switch">
                                        <input type="checkbox" id="showTaskbar" checked onchange="updatePreview()" aria-describedby="showTaskbar-tooltip">
                                        <span class="toggle-slider" aria-hidden="true"></span>
                                    </span>
                                    <label for="showTaskbar" class="with-tooltip">
                                        Show Taskbar
                                        <button type="button" class="tooltip-icon" aria-label="Help for Show Taskbar" aria-describedby="showTaskbar-tooltip">?</button>
                                        <span class="tooltip-content" id="showTaskbar-tooltip" role="tooltip">When enabled, users see the Windows taskbar with Start button and running apps. Disable for a more locked-down experience where users can only access apps via the Start menu.</span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="fileExplorerAccess" class="with-tooltip">
                                    File Explorer Access
                                    <button type="button" class="tooltip-icon" aria-label="Help for File Explorer Access" aria-describedby="fileExplorerAccess-tooltip">?</button>
                                    <span class="tooltip-content" id="fileExplorerAccess-tooltip" role="tooltip">No Access: File Explorer is blocked. Downloads Only: Access to Downloads folder. Removable Drives: Access to USB drives. Downloads + Removable: Both options. No Restriction: Full file system access.</span>
                                </label>
                                <select id="fileExplorerAccess" onchange="updatePreview()" aria-describedby="fileExplorerAccess-tooltip">
                                    <option value="none">No Access (Blocked)</option>
                                    <option value="downloads">Downloads Folder Only</option>
                                    <option value="removable">Removable Drives Only</option>
                                    <option value="downloads-removable">Downloads + Removable Drives</option>
                                    <option value="all">No Restriction (All Locations)</option>
                                </select>
                            </div>
                        </div>
                    </fieldset>
                    </div>
                    <!-- End System Tab -->

                </div>
                <!-- End tab-panels -->
            </div>
        </section>

        <!-- Preview Panel -->
        <section class="panel" aria-labelledby="preview-heading">
            <h2 id="preview-heading" class="panel-header">
                <span>XML Preview</span>
                <div class="export-actions" role="group" aria-label="Export options">
                    <button type="button" class="btn-secondary btn-small" onclick="copyXml()">Copy XML</button>
                    <button type="button" class="btn-primary btn-small" onclick="downloadXml()">Download XML</button>
                    <button type="button" class="btn-success btn-small" onclick="downloadPowerShell()">Download Deploy Script</button>
                </div>
            </h2>
            <div class="panel-content preview-content">
                <div id="validationStatus" role="status" aria-live="polite" aria-atomic="true"></div>
                <pre class="xml-preview" id="xmlPreview" aria-label="Generated XML configuration" tabindex="0">
                    <!-- XML will be rendered here -->
                </pre>
            </div>
        </section>
    </main>

    <label for="importInput" class="sr-only">Import XML configuration file</label>
    <input type="file" id="importInput" accept=".xml" style="display:none" onchange="handleImport(event)">

    <footer role="contentinfo">
        <p>
            Created by <a href="https://www.linkedin.com/in/joshua-walderbach/" target="_blank" rel="noopener noreferrer">Joshua Walderbach</a>
            <span aria-hidden="true">â€¢</span>
            Inspired by the work of <a href="https://www.linkedin.com/in/brandon-villines/" target="_blank" rel="noopener noreferrer">Brandon Villines</a>
        </p>
        <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem;">
            Last updated: 2025-12-16 10:15 AM
        </p>
    </footer>

    <!-- Deploy Guide Modal -->
    <div id="deployModal" class="modal hidden" role="dialog" aria-labelledby="deployModalTitle" aria-modal="true">
        <div class="modal-backdrop" onclick="hideDeployHelp()"></div>
        <div class="modal-content modal-wide">
            <div class="modal-header">
                <h2 id="deployModalTitle">Deployment Guide</h2>
                <button type="button" class="modal-close" onclick="hideDeployHelp()" aria-label="Close dialog">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Deploy Method Tabs -->
                <nav class="deploy-tabs" role="tablist" aria-label="Deployment methods">
                    <button type="button" class="deploy-tab active" role="tab" aria-selected="true" aria-controls="deploy-intune" id="deploy-tab-intune" onclick="switchDeployTab('intune')">Intune</button>
                    <button type="button" class="deploy-tab" role="tab" aria-selected="false" aria-controls="deploy-powershell" id="deploy-tab-powershell" onclick="switchDeployTab('powershell')">PowerShell</button>
                    <button type="button" class="deploy-tab" role="tab" aria-selected="false" aria-controls="deploy-ppkg" id="deploy-tab-ppkg" onclick="switchDeployTab('ppkg')">Provisioning Package</button>
                </nav>

                <!-- Intune Tab -->
                <div class="deploy-content active" role="tabpanel" id="deploy-intune" aria-labelledby="deploy-tab-intune">
                    <p class="deploy-description">Recommended for enterprise. Deploy via Microsoft Intune using a custom OMA-URI policy.</p>

                    <div class="deploy-steps">
                        <div class="deploy-step">
                            <h4>1. Navigate to Intune</h4>
                            <ul>
                                <li>Go to <a href="https://intune.microsoft.com" target="_blank" rel="noopener noreferrer">Microsoft Intune admin center</a></li>
                                <li>Select <strong>Devices</strong> â†’ <strong>Configuration profiles</strong></li>
                            </ul>
                        </div>

                        <div class="deploy-step">
                            <h4>2. Create Profile</h4>
                            <ul>
                                <li>Click <strong>+ Create profile</strong></li>
                                <li>Platform: <strong>Windows 10 and later</strong></li>
                                <li>Profile type: <strong>Templates</strong> â†’ <strong>Custom</strong></li>
                            </ul>
                        </div>

                        <div class="deploy-step">
                            <h4>3. Configure OMA-URI</h4>
                            <table class="oma-uri-table">
                                <tr><th>Field</th><th>Value</th></tr>
                                <tr><td>Name</td><td>AssignedAccess Configuration</td></tr>
                                <tr><td>OMA-URI</td><td><code>./Vendor/MSFT/AssignedAccess/Configuration</code></td></tr>
                                <tr><td>Data type</td><td>String</td></tr>
                                <tr><td>Value</td><td><em>(Paste your XML)</em></td></tr>
                            </table>
                        </div>

                        <div class="deploy-step">
                            <h4>4. Assign &amp; Deploy</h4>
                            <ul>
                                <li>Assign to a device group</li>
                                <li>Device will reboot to apply</li>
                            </ul>
                        </div>
                    </div>

                    <div class="deploy-note">
                        <strong>Requirements:</strong> Device must be Azure AD joined or Hybrid Azure AD joined.
                    </div>
                </div>

                <!-- PowerShell Tab -->
                <div class="deploy-content" role="tabpanel" id="deploy-powershell" aria-labelledby="deploy-tab-powershell">
                    <p class="deploy-description">For standalone devices or testing. Must be run as SYSTEM context.</p>

                    <div class="deploy-steps">
                        <div class="deploy-step">
                            <h4>Option A: Using Our Deploy Script</h4>
                            <p>Download the script using the <strong>Download Deploy Script</strong> button, then run:</p>
                            <pre class="deploy-code">psexec -i -s powershell.exe -ExecutionPolicy Bypass -File "C:\path\to\Apply-AssignedAccess.ps1"</pre>
                        </div>

                        <div class="deploy-step">
                            <h4>Option B: Manual Commands</h4>
                            <p>Run in SYSTEM context (via <code>psexec -i -s powershell.exe</code>):</p>
                            <pre class="deploy-code">$xml = Get-Content -Path "C:\path\to\config.xml" -Raw
$bridge = Get-CimInstance -Namespace "root\cimv2\mdm\dmmap" -ClassName "MDM_AssignedAccess"
Set-CimInstance -CimInstance $bridge -Property @{Configuration = $xml}</pre>
                        </div>
                    </div>

                    <div class="deploy-note">
                        <strong>Note:</strong> PsExec can be downloaded from <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec" target="_blank" rel="noopener noreferrer">Microsoft Sysinternals</a>.
                    </div>
                </div>

                <!-- Provisioning Package Tab -->
                <div class="deploy-content" role="tabpanel" id="deploy-ppkg" aria-labelledby="deploy-tab-ppkg">
                    <p class="deploy-description">For bulk deployment during OOBE or to existing devices.</p>

                    <div class="deploy-steps">
                        <div class="deploy-step">
                            <h4>1. Install Windows Configuration Designer</h4>
                            <ul>
                                <li>Download from <a href="https://apps.microsoft.com/detail/9nblggh4tx22" target="_blank" rel="noopener noreferrer">Microsoft Store</a> or Windows ADK</li>
                            </ul>
                        </div>

                        <div class="deploy-step">
                            <h4>2. Create Provisioning Package</h4>
                            <ul>
                                <li>Open Windows Configuration Designer</li>
                                <li>Select <strong>Advanced provisioning</strong></li>
                                <li>Navigate to: <strong>Runtime settings</strong> â†’ <strong>AssignedAccess</strong> â†’ <strong>AssignedAccessSettings</strong></li>
                                <li>Paste your XML configuration</li>
                            </ul>
                        </div>

                        <div class="deploy-step">
                            <h4>3. Export &amp; Apply</h4>
                            <ul>
                                <li>Export â†’ Provisioning package â†’ Create</li>
                                <li>Apply by double-clicking the .ppkg file or during Windows setup</li>
                            </ul>
                        </div>
                    </div>

                    <div class="deploy-note">
                        <strong>Tip:</strong> Provisioning packages can be applied during OOBE by placing them on a USB drive.
                    </div>
                </div>

                <!-- Common Notes -->
                <div class="deploy-footer">
                    <strong>All methods require:</strong> Windows 10/11 Pro, Enterprise, or Education. User/group accounts must exist before configuration is applied.
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
